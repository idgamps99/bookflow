<div class="activity-card-container">
  <% @trackers.each do |t| %>
    <%= link_to reading_list_path(t.reading_list), class: "session-card" do %>
      <div class="activity-cover">
        <%= image_tag t.reading_list.book.cover_url %>
      </div>
      <div class="activity-details">
        <h3 class="activity-title"><%= t.reading_list.book.title %></h3>
        <p class="activity-author"><%= t.reading_list.book.author %></p>
      </div>

      <div class="bf-progress">
        <% total_pages = t.reading_list.book.page_count %>
        <% current_page = t.current_page %>
        <% progress_percentage = total_pages.positive? ? (current_page.to_f / total_pages * 100).round : 0 %>

        <div class="bf-progress-bar" style="width: <%= progress_percentage %>%;"></div>
        <div class="bf-progress-text"><%= progress_percentage %>%</div>
      </div>

      <!-- Details -->
      <div class="activity-info">
        <div class="activity-row activity-time">
          <p>Time:</p>
          <p><%= Time.at(t.total_minutes_spent).utc.strftime("%H:%M:%S") %></p>
        </div>
        <div class="activity-row activity-pages">
          <p>Pages:</p>
          <p><%= t.current_page %></p>
        </div>
      </div>

      <!-- Mark book as read -->
      <% if t.reading_list.read? %>
        <div class="badge bg-success">Read</div>
      <% else %>
        <%= button_to "Mark as Read", mark_as_read_reading_list_path(t.reading_list), method: :patch, class: "btn btn-primary" %>
      <% end %>
    <% end %>
  <% end %>
</div>
